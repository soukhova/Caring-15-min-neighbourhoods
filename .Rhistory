tidyr::drop_na(Population)
#checks
# access_15_DA |> summary()
access_15_bycategory_DA |> summary()
access_15_DA$V_w_iscDA |> sum(na.rm=T)
access_15_bycategory_DA$V_ic_w |> sum(na.rm=T)
access_15_byspecificcategory_DA$V_isc_w |> sum(na.rm=T)
#RECALL, categories are either
# - "Dependent-centric" and include "Community or Recreation Centre", "Daycare or EarlyON", "Long-Term Care or Retirement Home", "Park", "School", "Senior Centre"
# - "Errand-centric" and include: "Bank or ATM", "Library", "Post Office"
# - "Grocery-centric" and include: "Convenience Store", "Grocer"
# - "Health-centric" and include: "Dentist", "Hospital or Clinic", "Pharmacy"
access_15_byspecificcategory_DA |> group_by(Care_Category_Specific) |> summarise(V_isc_w = sum(V_isc_w))
care_dest |> st_drop_geometry() |> group_by(Care_Category_Specific) |>
summarise(Dest_count_weighted = sum(Dest_count_weighted),
count = n())
#calculating entropy, here I do it by the 14 specific categories. This is a way to consider their diversity within and between categories. Because they have been weighted before calc. the cumulative opp counts, we can proceed without anymore adjustments.
step1 <- access_15_byspecificcategory_DA  |> group_by(GeoUID) |>
summarise(OPPi = sum(copp_isc_med, na.rm=T) + sum(copp_isc_sd, na.rm=T),
OPPi_w = sum(copp_isc_w_med, na.rm=T) + sum(copp_isc_w_sd, na.rm=T),
Vi_w = sum(V_isc_w))
step2 <- access_15_byspecificcategory_DA |> left_join(step1, by="GeoUID")
step2 <- step2 |> mutate(top1_copp = (copp_isc_med+copp_isc_sd) / OPPi * log((copp_isc_med+copp_isc_sd) / OPPi),
top1_copp = ifelse(is.nan(top1_copp), 0, top1_copp),
top1_coppw = (copp_isc_w_med+copp_isc_w_sd) / OPPi_w * log((copp_isc_w_med+copp_isc_w_sd) / OPPi_w),
top1_coppw = ifelse(is.nan(top1_coppw), 0, top1_coppw),
top1_Vw= (V_isc_w) / Vi_w * log((V_isc_w) / Vi_w),
top1_Vw = ifelse(is.nan(top1_Vw), 0, top1_Vw),)  |>
group_by(GeoUID) |>
summarise(entropy_copp_isc_medsd = sum(top1_copp) / -log(14),
entropy_copp_isc_medsd_w = sum(top1_coppw) / -log(14),
entropy_V_isc_w = sum(top1_Vw) / -log(14))
#join this to access_15_bycategory_DA
access_15_bycategory_DA <- access_15_bycategory_DA |> left_join(step2, by="GeoUID")
#the number of opportunities from each categories
all_cats <- access_15_bycategory_DA |>
mutate(copp_all = sum(copp_ic_med, na.rm=T) + sum(copp_ic_sd, na.rm=T),
copp_all_w = sum(copp_ic_w_med, na.rm=T) + sum(copp_ic_w_sd, na.rm=T)) |>
group_by(GeoUID) |>
summarise(summed_copp_all = sum(copp_all),
summed_copp_all_w = sum(copp_all_w),
summed_Vic_w = sum(V_ic_w, na.rm=T),
Population = mean(Population),
Care_Access_Status1 = case_when(summed_copp_all < 4 ~ "[0-04 des.) Not caring",
summed_copp_all >= 4 & summed_copp_all < 25 ~ "[04-25 des.) Caring",
summed_copp_all >= 25 ~ "[25+ des.) Very caring"),
Care_Access_Status1_w = case_when(summed_copp_all_w < 4 ~ "[0-04 des.) Not caring",
summed_copp_all_w >= 4 & summed_copp_all_w < 25 ~ "[04-25 des.) Caring",
summed_copp_all_w >= 25 ~ "[25+ des.) Very caring"),
Care_Access_Status2 = case_when(all(copp_all >= 2 & copp_all < 4) ~ "- complete (2 to 4 options per cat.)",
all(copp_all >= 4) ~ "- very complete (4 or more options per cat.)"),
Care_Access_Status2_w = case_when(all(copp_all_w >= 2 & copp_all_w < 4) ~ "- complete (2 to 4 options per cat.)",
all(copp_all_w >= 4) ~ "- very complete (4 or more options per cat.)"),
entropy_copp_isc_medsd = first(entropy_copp_isc_medsd),
entropy_copp_isc_medsd_w = first(entropy_copp_isc_medsd_w),
entropy_V_isc_w = first(entropy_V_isc_w)) |>
mutate(Care_Access_Status2 = ifelse(is.na(Care_Access_Status2), "", Care_Access_Status2),
Care_Access_Status2_w = ifelse(is.na(Care_Access_Status2_w), "", Care_Access_Status2_w),
Care_Access_Status = paste(Care_Access_Status1,Care_Access_Status2, sep=" "),
Care_Access_Status_w = paste(Care_Access_Status1_w,Care_Access_Status2_w, sep=" "),
vvi = summed_Vic_w/Population)
all_cats$summed_Vic_w |> sum() #only 2206  opps can be reached out of the total 2225, so that's what the numbers are based on.
care_dest|> nrow()
all_cats <- left_join(HAM_census_21 |> select(c(GeoUID)), all_cats, by=c("GeoUID"))
#tmap_mode("plot")
all_cats_copp_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("Care_Access_Status",
border.alpha = 0.2,
palette = c("darkred", "orangered", "orange", "yellow", "forestgreen", "lightgreen"),
title = "Number of care destinations (all) spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12
# legend.title.size = 0.7,
# legend.text.size = 0.6
)
tmap_save(all_cats_copp_plot, file="all_cats_copp_plot.tiff")
all_cats_copp_weighted_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("Care_Access_Status_w",
border.alpha = 0.2,
palette = c("darkred", "orangered", "orange", "yellow", "forestgreen", "lightgreen"),
title = "Number of care destinations (all - weighted) spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12
# legend.title.size = 0.7,
# legend.text.size = 0.6
)
tmap_save(all_cats_copp_weighted_plot, file="all_cats_copp_weighted_plot.tiff")
all_cats_entropy_copp_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("entropy_copp_isc_medsd",
border.alpha = 0.2,
palette = "Blues",
title = "Diversity of (all) care destinations spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12)
tmap_save(all_cats_copp_plot, file="all_cats_entropy_copp_plot.tiff")
all_cats_entropy_copp_weighted_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("entropy_copp_isc_medsd_w",
border.alpha = 0.2,
palette = "Blues",
title = "Diversity of (all - weighted) care destinations spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12)
tmap_save(all_cats_entropy_copp_weighted_plot, file="all_cats_entropy_copp_weighted_plot.tiff")
all_cats_vvi_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("vvi",
border.alpha = 0.2,
palette = c("orangered", "forestgreen"),
breaks = c(0, 0.003804, 0.022174),
labels = c("Below Median", "Median and above"),
title = "Per capita spatially available care destinations (all - weighted) within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12
)
tmap_save(all_cats_vvi_plot, file="all_cats_vvi_plot.tiff")
all_cats |> group_by(Care_Access_Status_w) |> summarise(min = min(summed_copp_all_w),
median = median(summed_copp_all_w),
max = max(summed_copp_all_w))
all_cats |> group_by(Care_Access_Status) |> summarise(min = min(summed_copp_all),
median = median(summed_copp_all),
max = max(summed_copp_all))
all_cats$entropy_copp_isc_medsd|> summary()
all_cats$entropy_copp_isc_medsd_w |> summary()
all_cats$Care_Access_Status_w |> unique()
#adding entropy labels
all_cats <- all_cats |>
mutate(bivariate_entropy_w =
case_when( ((Care_Access_Status_w == "[04-25 des.) Caring - complete (2 to 4 options per cat.)"  |
Care_Access_Status_w =="[04-25 des.) Caring - very complete (4 or more options per cat.)" |
Care_Access_Status_w =="[25+ des.) Very caring - very complete (4 or more options per cat.)") &
entropy_copp_isc_medsd_w >= 0.7154) ~ "Caring, complete and amenity diverse",  #the median diversity,
((Care_Access_Status_w == "[04-25 des.) Caring - complete (2 to 4 options per cat.)"  |
Care_Access_Status_w =="[04-25 des.) Caring - very complete (4 or more options per cat.)" |
Care_Access_Status_w =="[25+ des.) Very caring - very complete (4 or more options per cat.)") &
entropy_copp_isc_medsd_w < 0.7154) ~ "Caring, complete but not amenity diverse",
((Care_Access_Status_w == "[0-04 des.) Not caring " |
Care_Access_Status_w == "[04-25 des.) Caring ")  &
entropy_copp_isc_medsd_w >= 0.7154) ~ "Not caring or not complete, but amenity diverse",
((Care_Access_Status_w == "[0-04 des.) Not caring "  |
Care_Access_Status_w == "[04-25 des.) Caring ")  &
entropy_copp_isc_medsd_w < 0.7154) ~ "Not caring, complete, or amenity diverse"),
bivariate_entropy =
case_when( ((Care_Access_Status == "[04-25 des.) Caring - complete (2 to 4 options per cat.)"  |
Care_Access_Status =="[04-25 des.) Caring - very complete (4 or more options per cat.)" |
Care_Access_Status =="[25+ des.) Very caring - very complete (4 or more options per cat.)") &
entropy_copp_isc_medsd >= 0.7418) ~ "Caring, complete and amenity diverse",  #the median diversity,
((Care_Access_Status == "[04-25 des.) Caring - complete (2 to 4 options per cat.)"  |
Care_Access_Status =="[04-25 des.) Caring - very complete (4 or more options per cat.)" |
Care_Access_Status =="[25+ des.) Very caring - very complete (4 or more options per cat.)") &
entropy_copp_isc_medsd < 0.7418) ~ "Caring, complete but not amenity diverse",
((Care_Access_Status == "[0-04 des.) Not caring " |
Care_Access_Status == "[04-25 des.) Caring ")  &
entropy_copp_isc_medsd >= 0.7418) ~ "Not caring or not complete, but amenity diverse",
((Care_Access_Status == "[0-04 des.) Not caring "  |
Care_Access_Status == "[04-25 des.) Caring ")  &
entropy_copp_isc_medsd < 0.7418) ~ "Not caring, complete, or amenity diverse"))
all_cats_bivariate_entropy_copp_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("bivariate_entropy_w",
border.alpha = 0.2,
palette = c("yellowgreen","yellow","blue", "#FFFFDF"),
title = "Diversity of (all) care destinations spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12)
all_cats_entropy_copp_weighted_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("bivariate_entropy_w",
border.alpha = 0.2,
palette = c("yellowgreen","yellow","blue", "#FFFFDF"),
title = "Diversity of (all - weighted) care destinations spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12)
tmap_save(all_cats_entropy_copp_weighted_plot, file="all_cats_entropy_copp_weighted_plot.tiff")
all_cats_entropy_copp_weighted_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("entropy_copp_isc_medsd_w",
border.alpha = 0.2,
palette = "reds", style="quartiles", n=4,
title = "Diversity of (all - weighted) care destinations spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12)
tmap_save(all_cats_entropy_copp_weighted_plot, file="all_cats_entropy_copp_weighted_plot.tiff")
all_cats_entropy_copp_weighted_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("entropy_copp_isc_medsd_w",
border.alpha = 0.2,
palette = "reds", style="quartile", n=4,
title = "Diversity of (all - weighted) care destinations spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12)
tmap_save(all_cats_entropy_copp_weighted_plot, file="all_cats_entropy_copp_weighted_plot.tiff")
all_cats_entropy_copp_weighted_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("entropy_copp_isc_medsd_w",
border.alpha = 0.2,
palette = "reds", style="quantile", n=4,
title = "Diversity of (all - weighted) care destinations spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12)
tmap_save(all_cats_entropy_copp_weighted_plot, file="all_cats_entropy_copp_weighted_plot.tiff")
all_cats_entropy_copp_weighted_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("entropy_copp_isc_medsd_w",
border.alpha = 0.2,
palette = "Reds", style="quantile", n=4,
title = "Diversity of (all - weighted) care destinations spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12)
tmap_save(all_cats_entropy_copp_weighted_plot, file="all_cats_entropy_copp_weighted_plot.tiff")
400*3
tmap_save(pop_descriptive_plots, file="pop_descriptive_plots.tiff", asp = 1/2)
parcels_DA_plot <-
tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(access_15_DA) +
tm_polygons("parcel_count",
border.alpha = 0.2,
palette = "Reds",style = "quantile", n=4,
title = "Count of residential parcels",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("left", "top"), size=1.0)+
tm_layout(bg.color = "grey", panel.label.bg.color = "white", legend.position = c("right", "top"), legend.text.size = 0.5, legend.bg.color = "white", legend.bg.alpha = 0.4)
poprate_DA_plot <-
tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(access_15_DA |> mutate(popden = Population/Dwellings)) +
tm_polygons("popden",
border.alpha = 0.2,
palette = "Purples", style = "quantile", n=4,
title = "Population per dwelling",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("left", "top"), size=1.0)+
tm_layout(bg.color = "grey", panel.label.bg.color = "white", legend.position = c("right", "top"), legend.text.size = 0.5, legend.bg.color = "white", legend.bg.alpha = 0.4)
LICOAT_DA_plot <-
tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(access_15_DA) +
tm_polygons("LICO_AT_TOTAL",
border.alpha = 0.2,
palette = "Oranges", style = "quantile", n=4,
title = "Prevalance of household LICO-AT",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("left", "top"), size=1.0)+
tm_layout(bg.color = "grey", panel.label.bg.color = "white", legend.position = c("right", "top"), legend.text.size = 0.5, legend.bg.color = "white", legend.bg.alpha = 0.4)
pop_descriptive_plots <- tmap_arrange(parcels_DA_plot, poprate_DA_plot, LICOAT_DA_plot, nrow=3)
tmap_save(pop_descriptive_plots, file="pop_descriptive_plots.tiff", asp = 1/2)
tmap_save(pop_descriptive_plots, file="pop_descriptive_plots.tiff", asp = 1/1.5)
tmap_save(pop_descriptive_plots, file="pop_descriptive_plots.tiff", asp = 1/1.1)
tmap_save(pop_descriptive_plots, file="pop_descriptive_plots.tiff", asp = 1/0.9)
tmap_save(pop_descriptive_plots, file="pop_descriptive_plots.tiff", asp = 1/0.7)
tmap_save(pop_descriptive_plots, file="pop_descriptive_plots.tiff", asp = 1/0.6)
tmap_save(pop_descriptive_plots, file="pop_descriptive_plots.tiff", asp = 1/0.5)
LICOAT_DA_plot <-
tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(access_15_DA) +
tm_polygons("LICO_AT_TOTAL",
border.alpha = 0.2,
palette = "Oranges", style = "quantile", n=4,
title = "Prevalance of household LICO-AT",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("left", "top"), size=1.0)+
tm_layout(bg.color = "grey", panel.label.bg.color = "white", legend.position = c("right", "top"), legend.text.size = 0.5, legend.title.size = 0.7, legend.bg.color = "white", legend.bg.alpha = 0.4)
parcels_DA_plot <-
tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(access_15_DA) +
tm_polygons("parcel_count",
border.alpha = 0.2,
palette = "Reds",style = "quantile", n=4,
title = "Count of residential parcels",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("left", "top"), size=1.0)+
tm_layout(bg.color = "grey", panel.label.bg.color = "white", legend.position = c("right", "top"), legend.text.size = 0.5,legend.title.size = 0.7,  legend.bg.color = "white", legend.bg.alpha = 0.4)
poprate_DA_plot <-
tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(access_15_DA |> mutate(popden = Population/Dwellings)) +
tm_polygons("popden",
border.alpha = 0.2,
palette = "Purples", style = "quantile", n=4,
title = "Population per dwelling",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("left", "top"), size=1.0)+
tm_layout(bg.color = "grey", panel.label.bg.color = "white", legend.position = c("right", "top"), legend.text.size = 0.5,legend.title.size = 0.7,  legend.bg.color = "white", legend.bg.alpha = 0.4)
LICOAT_DA_plot <-
tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(access_15_DA) +
tm_polygons("LICO_AT_TOTAL",
border.alpha = 0.2,
palette = "Oranges", style = "quantile", n=4,
title = "Prevalance of household LICO-AT",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("left", "top"), size=1.0)+
tm_layout(bg.color = "grey", panel.label.bg.color = "white", legend.position = c("right", "top"), legend.text.size = 0.5, legend.title.size = 0.7, legend.bg.color = "white", legend.bg.alpha = 0.4)
pop_descriptive_plots <- tmap_arrange(parcels_DA_plot, poprate_DA_plot, LICOAT_DA_plot, nrow=3)
pop_descriptive_plots
tmap_save(pop_descriptive_plots, file="pop_descriptive_plots.tiff", asp = 1/0.5)
tmap_save(pop_descriptive_plots, file="pop_descriptive_plots.tiff", asp = 1/0.8)
tmap_save(pop_descriptive_plots, file="pop_descriptive_plots.tiff", asp = 1/0.6)
all_cats_entropy_copp_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("entropy_copp_isc_medsd",
border.alpha = 0.2,
palette = "Reds",
title = "Diversity of (all) care destinations spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12)
tmap_save(all_cats_entropy_copp_plot, file="all_cats_entropy_copp_plot.tiff")
all_cats_entropy_copp_weighted_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("entropy_copp_isc_medsd_w",
border.alpha = 0.2,
palette = "Reds",
title = "Diversity of (all - weighted) care destinations spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12)
tmap_save(all_cats_entropy_copp_weighted_plot, file="all_cats_entropy_copp_weighted_plot.tiff")
all_cats_bivariate_entropy_copp_plot <- tm_shape(ham_bay, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0) +
tm_shape(hydro_p_LakeOntario, bbox=Community_Boundaries) + tm_polygons(col="skyblue", border.alpha = 0)+
tm_shape(all_cats) +
tm_polygons("bivariate_entropy_w",
border.alpha = 0.2,
palette = c("yellowgreen","yellow","blue", "#FFFFDF"),
title = "Diversity of (all - weighted) care destinations spatially accessible within 15 min. walk",
legend.is.portrait = TRUE) +
tm_shape(Community_Boundaries) + tm_polygons(alpha=0)+
tm_scale_bar(position = c("left", "bottom"), breaks = c(0, 1, 5, 10, 15)) +
tm_compass(position = c("right", "top"), size=1.0)+
tm_layout(bg.color = "grey",
panel.label.bg.color = "white",
panel.label.color = "black",
legend.outside = TRUE,
legend.position = c("center", "bottom"),
legend.outside.position = "bottom",
legend.outside.size = 0.2,
legend.width = 12)
tmap_save(all_cats_bivariate_entropy_copp_plot, file="all_cats_bivariate_entropy_copp_plot.tiff")
word_comment("AS NOTE: thoughts on this?", "weighted to equal")
paste0('[', comment, ']{.comment-start id="0" author="Anastasia"',
'date="2023-08-12T15:00:00Z"}', highlight, '[]{.comment-end id="0"}')
#function for creating comments
word_comment <- function(comment, highlight = "") {
if (isTRUE(knitr:::pandoc_to() == "docx")) {
paste0('[', comment, ']{.comment-start id="0" author="Anastasia"',
'date="2023-08-12T15:00:00Z"}', highlight, '[]{.comment-end id="0"}')
}
}
word_comment("AS NOTE: thoughts on this?", "weighted to equal")
word_comment("AS NOTE: thoughts on this choice? I think we need to consider both the category type and the specific type in this paper. We justify the categories so that's fair but I still think there's value in presenting the specific type  some how - this is what I think this diversity index is good for so I've presented that as an option. Note though, it'd be much more simple to just focus on calculating the $D^{st}_{DA}$ using the $S_i^c$ and not introducing the $S_i^{st}$ calculation like I've done.. so I've made the analysis more complicated. Also destination weighting is based on the four categories - so that is distorting the diversity in certain ways.",".")
